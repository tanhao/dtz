{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\components/assets\\scripts\\components\\Game.js"],"names":["cc","Class","extends","Component","properties","seatLeft","Node","seatMyself","seatRight","seatUp","options","wangfa","Label","dipai8","Sprite","dipai9","settingWin","menuWin","_seatNodes","_myHoldPokers","_myFoldPokers","onLoad","addComponent","initView","initSeats","initEventHandlers","initWanfaLabel","initDipai","th","audioManager","playBGM","push","socketIOManager","seats","length","myholds","i","holds","getChildByName","j","children","sprite","getComponent","spriteFrame","log","hideOptions","initSingleSeat","seat","index","getLocalIndex","setInfo","userId","name","score","headImgUrl","setFangzhu","creator","setReady","ready","setOffline","online","self","dataEventHandler","node","on","data","console","JSON","stringify","string","getWanfa","dipai","getDipai","active","child","onMenuClicked","onBtnDissolveRequestClicked","alert","show","sio","send","onBtnDissolveClicked","onBtnLeaveClicked","isFangzhu","onBtnSettingClicked","onChatClicked","onVoiceClicked"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;;AAERC,kBAASL,GAAGM,IAFJ;AAGRC,oBAAWP,GAAGM,IAHN;AAIRE,mBAAUR,GAAGM,IAJL;AAKRG,gBAAOT,GAAGM,IALF;AAMRI,iBAAQV,GAAGM,IANH;AAORK,gBAAOX,GAAGY,KAPF;AAQRC,gBAAOb,GAAGc,MARF;AASRC,gBAAOf,GAAGc,MATF;;AAWRE,oBAAWhB,GAAGM,IAXN;AAYRW,iBAAQjB,GAAGM,IAZH;;AAcRY,oBAAW,EAdH;AAeRC,uBAAc,EAfN;AAgBRC,uBAAc;AAhBN,KAHP;;AAsBLC,UAtBK,oBAsBK;;AAEN,aAAKC,YAAL,CAAkB,OAAlB;;AAEA,aAAKC,QAAL;AACA,aAAKC,SAAL;AACA,aAAKC,iBAAL;AACA,aAAKC,cAAL;AACA,aAAKC,SAAL;AACAC,WAAGC,YAAH,CAAgBC,OAAhB,CAAwB,cAAxB;AACH,KAhCI;;;AAkCLP,cAAS,oBAAU;AACf,aAAKL,UAAL,CAAgBa,IAAhB,CAAqB,KAAKxB,UAA1B;AACA,aAAKW,UAAL,CAAgBa,IAAhB,CAAqB,KAAKvB,SAA1B;AACA,YAAGoB,GAAGI,eAAH,CAAmBC,KAAnB,CAAyBC,MAAzB,IAAiC,CAApC,EAAsC;AAClC,iBAAKhB,UAAL,CAAgBa,IAAhB,CAAqB,KAAKtB,MAA1B;AACH;AACD,aAAKS,UAAL,CAAgBa,IAAhB,CAAqB,KAAK1B,QAA1B;;AAEA,YAAI8B,UAAQ,CAAC,QAAD,EAAU,QAAV,CAAZ;AACA,aAAI,IAAIC,IAAE,CAAV,EAAYA,IAAED,QAAQD,MAAtB,EAA6BE,GAA7B,EAAiC;AAC7B,gBAAIC,QAAQ,KAAK9B,UAAL,CAAgB+B,cAAhB,CAA+BH,QAAQC,CAAR,CAA/B,CAAZ;AACA,iBAAI,IAAIG,IAAE,CAAV,EAAYA,IAAEF,MAAMG,QAAN,CAAeN,MAA7B,EAAoCK,GAApC,EAAwC;AACpC,oBAAIE,SAASJ,MAAMG,QAAN,CAAeD,CAAf,EAAkBG,YAAlB,CAA+B1C,GAAGc,MAAlC,CAAb;AACA,qBAAKK,aAAL,CAAmBY,IAAnB,CAAwBU,MAAxB;AACAA,uBAAOE,WAAP,GAAqB,IAArB;AACH;AACJ;AACD;AACA3C,WAAG4C,GAAH,CAAO,cAAY,KAAKzB,aAAL,CAAmBe,MAAtC;AACA;AACA;;AAEA,aAAKW,WAAL;AACH,KAzDI;;AA2DLrB,eAAU,qBAAU;AAChB,YAAIS,QAAML,GAAGI,eAAH,CAAmBC,KAA7B;AACA,aAAI,IAAIG,IAAI,CAAZ,EAAeA,IAAIH,MAAMC,MAAzB,EAAiC,EAAEE,CAAnC,EAAqC;AACjC,iBAAKU,cAAL,CAAoBb,MAAMG,CAAN,CAApB;AACH;AACJ,KAhEI;;AAkELU,oBAAe,wBAASC,IAAT,EAAc;AACzB,YAAIC,QAAQpB,GAAGI,eAAH,CAAmBiB,aAAnB,CAAiCF,KAAKC,KAAtC,CAAZ;AACA,aAAK9B,UAAL,CAAgB8B,KAAhB,EAAuBE,OAAvB,CAA+BH,KAAKI,MAApC,EAA2CJ,KAAKK,IAAhD,EAAqDL,KAAKM,KAA1D,EAAgEN,KAAKO,UAArE;AACA,aAAKpC,UAAL,CAAgB8B,KAAhB,EAAuBO,UAAvB,CAAkCR,KAAKI,MAAL,IAAavB,GAAGI,eAAH,CAAmBwB,OAAlE;AACA,aAAKtC,UAAL,CAAgB8B,KAAhB,EAAuBS,QAAvB,CAAgCV,KAAKW,KAArC;AACA,aAAKxC,UAAL,CAAgB8B,KAAhB,EAAuBW,UAAvB,CAAkC,CAACZ,KAAKa,MAAxC;AACH,KAxEI;;AA0ELnC,uBAAkB,6BAAU;AACxB,YAAIoC,OAAK,IAAT;AACAjC,WAAGI,eAAH,CAAmB8B,gBAAnB,GAAoC,KAAKC,IAAzC;;AAEA,aAAKA,IAAL,CAAUC,EAAV,CAAa,WAAb,EAA0B,UAAUC,IAAV,EAAgB;AACtCC,oBAAQtB,GAAR,CAAY,oBAAZ,EAAiCuB,KAAKC,SAAL,CAAeH,IAAf,CAAjC;AACH,SAFD;AAGA;AACA,aAAKF,IAAL,CAAUC,EAAV,CAAa,WAAb,EAA0B,UAAUC,IAAV,EAAgB;AACtCJ,iBAAKf,cAAL,CAAoBmB,IAApB;AACAC,oBAAQtB,GAAR,CAAY,oBAAZ,EAAiCuB,KAAKC,SAAL,CAAeH,IAAf,CAAjC;AACH,SAHD;;AAKA;AACA,aAAKF,IAAL,CAAUC,EAAV,CAAa,UAAb,EAAyB,UAAUC,IAAV,EAAgB;AACrCC,oBAAQtB,GAAR,CAAY,mBAAZ,EAAgCuB,KAAKC,SAAL,CAAeH,IAAf,CAAhC;AACH,SAFD;;AAIA;AACA,aAAKF,IAAL,CAAUC,EAAV,CAAa,YAAb,EAA2B,UAAUC,IAAV,EAAgB;AACvCJ,iBAAKf,cAAL,CAAoBmB,IAApB;AACAC,oBAAQtB,GAAR,CAAY,qBAAZ,EAAkCuB,KAAKC,SAAL,CAAeH,IAAf,CAAlC;AACH,SAHD;;AAKC;AACD,aAAKF,IAAL,CAAUC,EAAV,CAAa,eAAb,EAA8B,UAAUC,IAAV,EAAgB;;AAE1CC,oBAAQtB,GAAR,CAAY,wBAAZ,EAAqCuB,KAAKC,SAAL,CAAeH,IAAf,CAArC;AACH,SAHD;AAIA;AACA,aAAKF,IAAL,CAAUC,EAAV,CAAa,YAAb,EAA2B,UAAUC,IAAV,EAAgB;;AAEvCC,oBAAQtB,GAAR,CAAY,qBAAZ,EAAkCuB,KAAKC,SAAL,CAAeH,IAAf,CAAlC;AACH,SAHD;AAMH,KA9GI;;AAgHLvC,oBAAe,0BAAU;AACrB,aAAKf,MAAL,CAAY0D,MAAZ,GAAmBzC,GAAGI,eAAH,CAAmBsC,QAAnB,EAAnB;AACH,KAlHI;AAmHL3C,eAAU,qBAAU;AAChB,YAAI4C,QAAM3C,GAAGI,eAAH,CAAmBwC,QAAnB,EAAV;AACA,YAAGD,SAAO,CAAV,EAAY;AACR,iBAAK1D,MAAL,CAAYkD,IAAZ,CAAiBU,MAAjB,GAAwB,IAAxB;AACA,iBAAK1D,MAAL,CAAYgD,IAAZ,CAAiBU,MAAjB,GAAwB,KAAxB;AACH,SAHD,MAGM,IAAGF,SAAO,CAAV,EAAY;AACd,iBAAK1D,MAAL,CAAYkD,IAAZ,CAAiBU,MAAjB,GAAwB,KAAxB;AACA,iBAAK1D,MAAL,CAAYgD,IAAZ,CAAiBU,MAAjB,GAAwB,IAAxB;AACH,SAHK,MAGD;AACD,iBAAK5D,MAAL,CAAYkD,IAAZ,CAAiBU,MAAjB,GAAwB,KAAxB;AACA,iBAAK1D,MAAL,CAAYgD,IAAZ,CAAiBU,MAAjB,GAAwB,KAAxB;AACH;AACJ,KA/HI;AAgIL;;;;;AAKA5B,iBAAY,qBAASoB,IAAT,EAAc;AACtB,aAAKvD,OAAL,CAAa+D,MAAb,GAAoB,KAApB;AACA,aAAI,IAAIrC,IAAE,CAAV,EAAYA,IAAE,KAAK1B,OAAL,CAAa8B,QAAb,CAAsBN,MAApC,EAA2CE,GAA3C,EAA+C;AAC3C,gBAAIsC,QAAQ,KAAKhE,OAAL,CAAa8B,QAAb,CAAsBJ,CAAtB,CAAZ;AACAsC,kBAAMD,MAAN,GAAa,KAAb;AACH;AACJ,KA3II;;AA6ILE,mBAAc,yBAAU;AACpB,aAAK1D,OAAL,CAAawD,MAAb,GAAoB,CAAC,KAAKxD,OAAL,CAAawD,MAAlC;AACH,KA/II;AAgJLG,iCAA4B,uCAAU;AAClC,aAAK3D,OAAL,CAAawD,MAAb,GAAoB,KAApB;AACA7C,WAAGiD,KAAH,CAASC,IAAT,CAAc,QAAd,EAAuB,wBAAvB,EAAgD,YAAU;AACtDlD,eAAGmD,GAAH,CAAOC,IAAP,CAAY,kBAAZ;AACH,SAFD,EAEE,IAFF;AAGH,KArJI;AAsJLC,0BAAqB,gCAAU;AAC3B,aAAKhE,OAAL,CAAawD,MAAb,GAAoB,KAApB;AACA7C,WAAGiD,KAAH,CAASC,IAAT,CAAc,MAAd,EAAqB,kBAArB,EAAwC,YAAU;AAC9ClD,eAAGmD,GAAH,CAAOC,IAAP,CAAY,UAAZ;AACH,SAFD,EAEE,IAFF;AAGH,KA3JI;AA4JLE,uBAAkB,6BAAU;AACxB,YAAGtD,GAAGI,eAAH,CAAmBmD,SAAnB,EAAH,EAAkC;AAC9BvD,eAAGiD,KAAH,CAASC,IAAT,CAAc,MAAd,EAAqB,cAArB,EAAoC,YAAU;AAC1ClD,mBAAGmD,GAAH,CAAOC,IAAP,CAAY,OAAZ;AACH,aAFD;AAGA;AACH;AACD,aAAK/D,OAAL,CAAawD,MAAb,GAAoB,KAApB;AACA7C,WAAGiD,KAAH,CAASC,IAAT,CAAc,MAAd,EAAqB,WAArB,EAAiC,YAAU;AACvClD,eAAGmD,GAAH,CAAOC,IAAP,CAAY,OAAZ;AACH,SAFD,EAEE,IAFF;AAGH,KAvKI;AAwKLI,yBAAoB,+BAAU;AAC1B,aAAKnE,OAAL,CAAawD,MAAb,GAAoB,KAApB;AACA,aAAKzD,UAAL,CAAgByD,MAAhB,GAAuB,IAAvB;AACH,KA3KI;AA4KLY,mBAAc,yBAAU;AACpBrF,WAAG4C,GAAH,CAAO,kBAAP;AACH,KA9KI;AA+KL0C,oBAAe,0BAAU;AACrBtF,WAAG4C,GAAH,CAAO,mBAAP;AACH;;AAjLI,CAAT","file":"Game.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n       \r\n        seatLeft:cc.Node,\r\n        seatMyself:cc.Node,\r\n        seatRight:cc.Node,\r\n        seatUp:cc.Node,\r\n        options:cc.Node,\r\n        wangfa:cc.Label,\r\n        dipai8:cc.Sprite,\r\n        dipai9:cc.Sprite,\r\n\r\n        settingWin:cc.Node,\r\n        menuWin:cc.Node,\r\n\r\n        _seatNodes:[],\r\n        _myHoldPokers:[],\r\n        _myFoldPokers:[]\r\n    },\r\n\r\n    onLoad () {\r\n\r\n        this.addComponent(\"Folds\");\r\n\r\n        this.initView();\r\n        this.initSeats();\r\n        this.initEventHandlers();\r\n        this.initWanfaLabel();\r\n        this.initDipai();\r\n        th.audioManager.playBGM(\"bg_fight.mp3\");\r\n    },\r\n\r\n    initView:function(){\r\n        this._seatNodes.push(this.seatMyself);\r\n        this._seatNodes.push(this.seatRight);\r\n        if(th.socketIOManager.seats.length==4){\r\n            this._seatNodes.push(this.seatUp);\r\n        }\r\n        this._seatNodes.push(this.seatLeft);\r\n\r\n        var myholds=['Holds1','Holds2'];\r\n        for(var i=0;i<myholds.length;i++){\r\n            var holds = this.seatMyself.getChildByName(myholds[i]);\r\n            for(var j=0;j<holds.children.length;j++){\r\n                var sprite = holds.children[j].getComponent(cc.Sprite);\r\n                this._myHoldPokers.push(sprite);\r\n                sprite.spriteFrame = null;\r\n            }\r\n        }\r\n        //this.initDragStuffs(sprite.node);\r\n        cc.log(\"mypokers:\"+this._myHoldPokers.length);\r\n        //var realwidth = cc.director.getVisibleSize().width;\r\n        //cc.log(\"realWidth:\"+(realwidth/1280));\r\n\r\n        this.hideOptions();\r\n    },\r\n\r\n    initSeats:function(){\r\n        var seats=th.socketIOManager.seats;\r\n        for(var i = 0; i < seats.length; ++i){\r\n            this.initSingleSeat(seats[i]);\r\n        }\r\n    },\r\n\r\n    initSingleSeat:function(seat){\r\n        var index = th.socketIOManager.getLocalIndex(seat.index);\r\n        this._seatNodes[index].setInfo(seat.userId,seat.name,seat.score,seat.headImgUrl);\r\n        this._seatNodes[index].setFangzhu(seat.userId==th.socketIOManager.creator);\r\n        this._seatNodes[index].setReady(seat.ready);\r\n        this._seatNodes[index].setOffline(!seat.online);\r\n    },\r\n\r\n    initEventHandlers:function(){\r\n        var self=this;\r\n        th.socketIOManager.dataEventHandler=this.node;\r\n\r\n        this.node.on('init_room', function (data) {\r\n            console.log('==>Gmae init_room:',JSON.stringify(data));\r\n        });\r\n        //加入房间\r\n        this.node.on('join_push', function (data) {\r\n            self.initSingleSeat(data);\r\n            console.log('==>Gmae join_push:',JSON.stringify(data));\r\n        });\r\n\r\n        //检查IP\r\n        this.node.on('check_ip', function (data) {\r\n            console.log('==>Gmae check_ip:',JSON.stringify(data));\r\n        });\r\n\r\n        //离开房间\r\n        this.node.on('leave_push', function (data) {\r\n            self.initSingleSeat(data);\r\n            console.log('==>Gmae leave_push:',JSON.stringify(data));\r\n        });\r\n\r\n         //解散房间\r\n        this.node.on('dissolve_push', function (data) {\r\n\r\n            console.log('==>Gmae dissolve_push:',JSON.stringify(data));\r\n        });\r\n        //断线\r\n        this.node.on('disconnect', function (data) {\r\n\r\n            console.log('==>Gmae disconnect:',JSON.stringify(data));\r\n        });\r\n        \r\n\r\n    },\r\n\r\n    initWanfaLabel:function(){\r\n        this.wangfa.string=th.socketIOManager.getWanfa();\r\n    },\r\n    initDipai:function(){\r\n        var dipai=th.socketIOManager.getDipai();\r\n        if(dipai==8){\r\n            this.dipai8.node.active=true;\r\n            this.dipai9.node.active=false;\r\n        }else if(dipai==9){\r\n            this.dipai8.node.active=false;\r\n            this.dipai9.node.active=true;\r\n        }else{\r\n            this.dipai8.node.active=false;\r\n            this.dipai9.node.active=false;\r\n        }\r\n    },\r\n    /*\r\n    update (dt) {\r\n    },\r\n    */\r\n\r\n    hideOptions:function(data){\r\n        this.options.active=false;\r\n        for(var i=0;i<this.options.children.length;i++){\r\n            var child = this.options.children[i]; \r\n            child.active=false;\r\n        }\r\n    },\r\n\r\n    onMenuClicked:function(){\r\n        this.menuWin.active=!this.menuWin.active;\r\n    },\r\n    onBtnDissolveRequestClicked:function(){\r\n        this.menuWin.active=false;\r\n        th.alert.show(\"申请解散房间\",\"申请解散房间不会退换钻石，是否确定申请解散？\",function(){\r\n            th.sio.send(\"dissolve_request\"); \r\n        },true)\r\n    },\r\n    onBtnDissolveClicked:function(){\r\n        this.menuWin.active=false;\r\n        th.alert.show(\"解散房间\",\"解散房间不扣钻石，是否确定解散？\",function(){\r\n            th.sio.send(\"dissolve\"); \r\n        },true)\r\n    },\r\n    onBtnLeaveClicked:function(){\r\n        if(th.socketIOManager.isFangzhu()){\r\n            th.alert.show(\"离开房间\",\"您是房主，不能离开房间。\",function(){\r\n                th.sio.send(\"leave\"); \r\n            })\r\n            return ;\r\n        }\r\n        this.menuWin.active=false;\r\n        th.alert.show(\"离开房间\",\"您确定要离开房间?\",function(){\r\n            th.sio.send(\"leave\"); \r\n        },true)\r\n    },\r\n    onBtnSettingClicked:function(){\r\n        this.menuWin.active=false;\r\n        this.settingWin.active=true;\r\n    },\r\n    onChatClicked:function(){\r\n        cc.log('onChatClicked==>');\r\n    },\r\n    onVoiceClicked:function(){\r\n        cc.log('onVoiceClicked==>');\r\n    },\r\n\r\n\r\n});\r\n"]}